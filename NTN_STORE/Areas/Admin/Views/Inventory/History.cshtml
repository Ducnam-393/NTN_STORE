@model IEnumerable<NTN_STORE.Models.InventoryLog>
@{
    ViewData["Title"] = "Lịch sử kho";
    Layout = "~/Areas/Admin/Views/Shared/_AdminLayout.cshtml";

    int currentPage = ViewBag.CurrentPage;
    int totalPages = ViewBag.TotalPages;
}

<div class="card shadow mb-4">
    <div class="card-header py-3 d-flex justify-content-between align-items-center">
        <h6 class="m-0 font-weight-bold text-primary">Nhật ký hoạt động kho</h6>
        <a href="/Admin/Inventory" class="btn btn-secondary btn-sm">Quay lại</a>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-bordered table-striped" width="100%" cellspacing="0">
                <thead>
                    <tr>
                        <th>Thời gian</th>
                        <th>Người thực hiện</th>
                        <th>Hành động</th>
                        <th>Sản phẩm</th>
                        <th>Thay đổi</th>
                        <th>Tồn cuối</th>
                        <th>Mã phiếu</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var log in Model)
                    {
                        <tr>
                            <td>@log.CreatedAt.ToString("dd/MM/yyyy HH:mm")</td>
                            <td>@log.UserId</td>
                            <td>
                                @if (log.Action == "Import")
                                {
                                    <span class="badge badge-success">Nhập hàng</span>
                                }
                                else if (log.Action == "Sale")
                                {

                                    <span class="badge badge-warning">Bán hàng</span>
                                }
                                else if (log.Action.Contains("Delete"))
                                {

                                    <span class="badge badge-danger">Xóa SP</span>
                                }
                                else
                                {

                                    <span class="badge badge-secondary">@log.Action</span>
                                }
                            </td>
                            <td>
                                <span class="font-weight-bold">@log.Variant?.Product?.Name</span> <br>
                                <small>(@log.Variant?.Color - @log.Variant?.Size)</small>
                            </td>
                            <td class="font-weight-bold @(log.ChangeAmount > 0 ? "text-success" : "text-danger")">
                                @(log.ChangeAmount > 0 ? "+" : "")@log.ChangeAmount
                            </td>
                            <td>@log.RemainingStock</td>
                            <td><small>@log.ReferenceCode</small></td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>

        @if (totalPages > 1)
        {
            <nav aria-label="Page navigation" class="mt-3">
                <ul class="pagination justify-content-center mb-0">
                    <li class="page-item @(currentPage == 1 ? "disabled" : "")">
                        <a class="page-link" href="/Admin/Inventory/History?page=@(currentPage - 1)">Trước</a>
                    </li>

                    @for (int i = 1; i <= totalPages; i++)
                    {
                        <li class="page-item @(currentPage == i ? "active" : "")">
                            <a class="page-link" href="/Admin/Inventory/History?page=@i">@i</a>
                        </li>
                    }

                    <li class="page-item @(currentPage == totalPages ? "disabled" : "")">
                        <a class="page-link" href="/Admin/Inventory/History?page=@(currentPage + 1)">Sau</a>
                    </li>
                </ul>
            </nav>
        }
    </div>
</div>